<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-title>Profile</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content color="light">
  <div class="profile-card">
    <div class="avatar-wrapper" (click)="fileInput.click()">
      <ion-avatar class="main-avatar">
        @if (userProfile?.avatar_url) {
          <img [src]="userProfile.avatar_url" />
        } @else {
          <div class="initials">{{ getInitials(userProfile?.username) }}</div>
        }
      </ion-avatar>
      
      <div class="camera-badge">
        <ion-icon name="camera"></ion-icon>
      </div>

      @if (isUploading) {
        <div class="upload-spin">
          <ion-spinner name="crescent" color="light"></ion-spinner>
        </div>
      }
    </div>

    <input type="file" #fileInput style="display: none" (change)="onFileSelected($event)" accept="image/png, image/jpeg" />

    <div class="identity-section">
      <h2>@{{ userProfile?.username || 'user' }}</h2>
      <p>{{ userProfile?.email }}</p>
    </div>

    <div class="info-grid">
      <div class="info-box">
        <ion-icon name="calendar-clear-outline"></ion-icon>
        <span>{{ userProfile?.created_at | date:'MMM yyyy' }}</span>
      </div>
      <div class="info-box">
        <ion-icon name="shield-checkmark-outline"></ion-icon>
        <span>Verified Member</span>
      </div>
    </div>
  </div>

  <ion-list [inset]="true" class="action-list">
    <ion-item (click)="signOut()" button="true" lines="none" class="logout-item">
      <ion-icon slot="start" name="log-out-outline"></ion-icon>
      <ion-label>Sign Out</ion-label>
    </ion-item>
  </ion-list>

  <div class="footer-note">
    <p>Private Profile â€¢ Spread v{{ appVersion }}</p>
  </div>
</ion-content>